\documentclass{article}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyfoot{}
\fancyfoot[C]{\thepage}
\rhead{Yarosevich - 1064712}
\usepackage{setspace}
\usepackage{siunitx} % Provides the \SI{}{} and \si{} command for typesetting SI units
\usepackage{graphicx} % Required for the inclusion of images
\usepackage{amsmath} % Required for some math elements 
\usepackage[export]{adjustbox} % loads also graphicx
\usepackage{listings}
\usepackage{setspace}
\usepackage{matlab-prettifier}
\usepackage{float}
\usepackage[most]{tcolorbox}
\usepackage{amsfonts}
\usepackage{color}
\usepackage{titlesec}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{placeins}
\usepackage{bm}
\usepackage{esvect}
\newcommand{\uveci}{{\bm{\hat{\textnormal{\bfseries\i}}}}}
\newcommand{\uvecj}{{\bm{\hat{\textnormal{\bfseries\j}}}}}
\DeclareRobustCommand{\uvec}[1]{{%
  \ifcsname uvec#1\endcsname
     \csname uvec#1\endcsname
   \else
    \bm{\hat{\mathbf{#1}}}%
   \fi
}}


\newcommand{\R}{\mathbb{R}}

\usepackage{xcolor}

\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{%
  \parbox{\textwidth}{\colorbox{gray}{\parbox{\textwidth}{#1#2#3}}\vskip-4pt}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white}
\lstset{frame=lrb,xleftmargin=\fboxsep,xrightmargin=-\fboxsep}
\titleformat{\section}[runin]
  {\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}[runin]
  {\normalfont\large\bfseries}{\thesubsection}{1em}{}


\setlength\parindent{0pt} % Removes all indentation from paragraphs

\renewcommand{\labelenumi}{\alph{enumi}.} % Make numbering in the enumerate environment by letter rather than number (e.g. section 6)

%\usepackage{times} % Uncomment to use the Times New Roman font

%----------------------------------------------------------------------------------------
%	DOCUMENT INFORMATION
%----------------------------------------------------------------------------------------

\title{AMATH 503: Homework 2 \\Due April, 22 2019 \\ ID: 1064712} % Title

\author{Trent \textsc{Yarosevich}} % Author name

\date{\today} % Date for the report

\begin{document}
\maketitle % Insert the title, author and date
\setlength\parindent{1cm}

\begin{center}
\begin{tabular}{l r}
%Date Performed: December 1, 2017 \\ % Date the experiment was performed
Instructor: Ka-Kit Tung % Instructor/supervisor
\end{tabular}
\end{center}
\doublespacing
% If you wish to include an abstract, uncomment the lines below
% \begin{abstract}
% Abstract text
% \end{abstract}

%----------------------------------------------------------------------------------------
%	SECTION 1
%----------------------------------------------------------------------------------------
\section*{\textbf{(a)}}
\textbf{A few preliminaries:} I will frequently refer back to the results in section \textbf{(a)} as the work will be repeated throughout. I will also be using the ansatz solutions for ODEs from section 1 of the notes. Also please note that I will often use the fact that $cos(n\pi) = (-1)^n$.\\
\\

Assuming a solution of the form $u(x,t) = X(x)T(t)$ we have the following, with $K$ being an arbitrary constant.
\begin{equation}
\begin{aligned}
\frac{T''(t)}{T(t)} = \frac{X''(x)}{X(x)} = K
\end{aligned}
\end{equation}
If we suppose $K=0$ we quickly get a trivial soution:
\begin{equation}
\begin{aligned}
X''(x) = 0\\
X(x) = Ax + B\\
X(0) = A(0) + B=0\\
B=0
X(\pi) = A(\pi) = 0\\
A = 0
\end{aligned}
\end{equation}
Similarly, if $K>0$ we have solutions of the form:
\begin{equation}
\begin{aligned}
X(x) = Ae^{\sqrt{x}} + Be^{-\sqrt{x}}\\
X(0) = A + B = 0\\
B = -A\\
X(\pi) = Ae^{\sqrt{\pi}} -Ae^{-\sqrt{\pi}} = 0\\
A = 0
\end{aligned}
\end{equation}
These trivial solutions have been covered quite a bit, but I include them here for later reference. We now proceed with $-\lambda^2 = K < 0$.
\begin{equation}
\begin{aligned}
X(x) = Asin(\lambda x) + Bcos(\lambda x)\\
X(0) = B = 0\\
X(\pi) = Asin(\lambda \pi)\\
\lambda\pi = \pi n\\
\lambda = n\\
X_n(x) = A_nsin(nx)\\
\end{aligned}
\end{equation}
We combine this with the $T$ equation to get a general solution, consolidating the arbitrary constant from the $X$ equation, and then applying the ICs:
\begin{equation}
\begin{aligned}
T_n(t) = A_nsin(nt) + B_ncos(nt)\\
\sum^{\infty}_{n=1}\Big{[}A_nsin(nt) + B_ncos(nt)\Big{]}sin(nx)\\
u(x,0) = \sum^{\infty}_{n=1}B_nsin(nx) = 1\\
B_n = \frac{2}{\pi}\int_0^\pi sin(nx)dx = \frac{2}{\pi}\Big{[}\frac{-cos(nx)}{n}\Big{]}\Big{|}^\pi_0\\
 B_n = \frac{2}{\pi}(\frac{-cos(n\pi) + 1)}{n})\\
 B_n = \frac{2- 2(-1)^n}{\pi n}
\end{aligned}
\end{equation}
To apply the other IC we need the time derivative:
\begin{equation}
\begin{aligned}
u_t(x,t) = \sum_{n=1}^{\infty}\Big{[}A_nncos(nt) - B_nnsin(nt)\Big{]}sin(nx)\\
u_t(x,0) =\sum_{n=1}^{\infty} A_nsin(nx) = 0
\end{aligned}
\end{equation}
It has been asserted in class and office hours without proof that for a series of this form to be equal to zero, the coefficient must be zero, thus we have $A_n = 0$. Combining these we have the complete solution:
\begin{tcolorbox}[minipage,colback=white,arc=0pt,outer arc=0pt]
\begin{equation}
\begin{aligned}
u(x,t) = \frac{2}{\pi}\sum_{n=1}^{\infty}\frac{1 -(-1)^n}{n}cos(nt)(sin(nx)\\
\text{Or perhaps more efficiently, let $j=2n+1$:}\\
u(x,t) = \frac{2}{\pi}\sum_{j=0}^{\infty}\frac{1 -(-1)^j}{j}cos(jt)(sin(jx)\\
\end{aligned}
\end{equation}
\end{tcolorbox}
\section*{\textbf{(b)}}
We can observe from sections \textbf{(2)} and \textbf{(3)} above that the addition of the coefficient of $2$ in this problem will not change the triviality of solutions with $K=0$ and $K>0$, therefore we move directly to solutions with $K<0$. Given the formula,
\begin{equation}
\begin{aligned}
\frac{T''(t)}{2T(t)} = \frac{X''(x)}{X(x)} = -\lambda^2
\end{aligned}
\end{equation}
we can see that the $X(x)$ equation will be identical to \textbf{(4)}. We therefore move on to the $T(t)$ equation, again using the ansatz from the notes and the fact that $\lambda = n$:
\begin{equation}
\begin{aligned}
T_n(t) = A_nsin(\sqrt{2}nt) + B_ncos(\sqrt{2}nt)
\end{aligned}
\end{equation}
The resulting general solution before applying ICs is thus:
\begin{equation}
\begin{aligned}
u(x,t) = \sum^{\infty}_{n=1}\Big{[}A_nsin(\sqrt{2}nt) + B_ncos(\sqrt{2}nt)\Big{]}sin(nx)
\end{aligned}
\end{equation}
Now applying the first IC:
\begin{equation}
\begin{aligned}
u(x,0) = \sum_{n=1}^{\infty}B_nsin(nx) = 0\\
\end{aligned}
\end{equation}
For the reasons given near \textbf{(6)} above $B_n=0$, we now take the time derivative and apply the other IC:
\begin{equation}
\begin{aligned}
u(x,t) = \sum_{n=1}^{\infty}A_nsin(\sqrt{2}nt)sin(nx)\\
u_t(x,t) = \sum_{n=1}^{\infty}n\sqrt{2}A_ncos(\sqrt{2}nt)sin(nx)\\
u_t(x,0) = \sum_{n=1}^{\infty}n\sqrt{2}A_nsin(nx) = 1\\
n\sqrt{2}A_n = \frac{2}{\pi}\int^\pi_0sin(nx)dx
\end{aligned}
\end{equation}
We can recover the result of this integral from \textbf{(5)} above, giving:
\begin{equation}
\begin{aligned}
n\sqrt{2}A_n  = \frac{2- 2(-1)^n}{\pi n}\\
A_n = \frac{2- 2(-1)^n}{\sqrt{2}\pi n^2}
\end{aligned}
\end{equation}
Thus we have the full solution:
\begin{tcolorbox}[minipage,colback=white,arc=0pt,outer arc=0pt]
\begin{equation}
\begin{aligned}
u(x,t) = \frac{2}{\pi\sqrt{2}}\sum^{\infty}_{n=1}\Big{[}\frac{1-(-1)^n}{n^2}sin(\sqrt{2}nt)\Big{]}sin(nx)\\
\text{Or perhaps more efficiently let $j=2n+1$:}\\
u(x,t) = \frac{2}{\pi\sqrt{2}}\sum^{\infty}_{j=1}\Big{[}\frac{1-(-1)^j}{j^2}sin(\sqrt{2}jt)\Big{]}sin(jx)\\
\end{aligned}
\end{equation}
\end{tcolorbox}
\section*{\textbf{(c)}}
For the same reasons stated above in \textbf{(8)} and \textbf{(9)} we can move directly to the general solution, simply substituting $\sqrt{3}$ in place of $\sqrt{2}$:
\begin{equation}
\begin{aligned}
u(x,t) = \sum^{\infty}_{n=1}\Big{[}A_nsin(\sqrt{3}nt) + B_ncos(\sqrt{3}nt)\Big{]}sin(nx)
\end{aligned}
\end{equation}
We will first take the time derivative in order to apply an IC that is likely to eliminate a coefficient:
\begin{equation}
\begin{aligned}
u_t(x,t) = \sum^{\infty}_{n=1}\Big{[}n\sqrt{3}A_ncos(\sqrt{3}nt) - n\sqrt{3}B_nsin(\sqrt{3}nt)\Big{]}sin(nx)\\
u_t(x,0) = \sum_{n=1}^{\infty}n\sqrt{3}A_nsin(nx) = 0
\end{aligned}
\end{equation}
Again, for the reasons state in \textbf{(6)} $A_n = 0$. Making this substitution, we then apply the other IC:
\begin{equation}
\begin{aligned}
u(x,t) = \sum_{n=1}^{\infty}B_ncos(\sqrt{3}nt)sin(nx)\\
u(x,0) = \sum_{n=1}^{\infty}B_nsin(nx) = sin^3(x)
\end{aligned}
\end{equation}	
Rather than using an integral to determine $B_n$ here, we can simply observe that the objective is to obtain a sine series for $sin^3(x)$. By the triple-angle formula we can see that $sin^3x = \frac{3}{4}sinx - \frac{1}{4}sin(3x)$. It is immediately clear that this \textit{is} a sine series with only two terms at $n=1$ and $n=3$ with corresponding coefficients $B_1 = \frac{3}{4}$ and $B_3 = -\frac{1}{4}$. Since all other terms are zero, the resulting function is quite simple, since the only values remaining from the sum are n=1 and n=3. 
\begin{tcolorbox}[minipage,colback=white,arc=0pt,outer arc=0pt]
\begin{equation}
\begin{aligned}
u(x,t) = \frac{3}{4}cos(\sqrt{3}t)sin(x) - \frac{1}{4}cos(3\sqrt{3}t)sin(3x)
\end{aligned}
\end{equation}
\end{tcolorbox}
\section*{\textbf{(d)}}
As in \textbf{(15)} above, we can move directly to the following, substituting $\sqrt{4} = 2$ for $\sqrt{3}$:
\begin{equation}
\begin{aligned}
u(x,t) = \sum^{\infty}_{n=1}\Big{[}A_nsin(2nt) + B_ncos(2nt)\Big{]}sin(nx)
\end{aligned}
\end{equation}
Applying the first IC we have:
\begin{equation}
\begin{aligned}
u(x,0)=\sum_{n=1}^{\infty}B_nsin(nx) = x\\
B_n = \frac{2}{\pi}\int_0^\pi xsin(x)dx\\
u = x \text{ , } du = 1\\
dv = sin(nx)\\
v = \frac{-1}{n}cos(nx)\\
uv - \int vdu = \frac{-x cos(nx)}{n} + \frac{sin(nx)}{n^2}\\
\Big{[}\frac{-x cos(nx)}{n} + \frac{sin(nx)}{n^2}\Big{]}\Big{|}^\pi_0 = (\frac{-\pi cos(n\pi)}{n})\\
B_n = \frac{2}{\pi}(\frac{-\pi (-1)^n}{n}) = \frac{-2(-1)^n}{n}
\end{aligned}
\end{equation}
To apply the other IC we take the time derivative (note I will retain the arbitrary coefficients for brevity):
\begin{equation}
\begin{aligned}
u_t(x,t)= \sum^{\infty}_{n=1}\Big{[}2nA_ncos(2nt) - 2nB_ncsin(2nt)\Big{]}sin(nx)\\
u_t(x,0) = \sum_{n=1}^{\infty}2nA_nsin(nx) = -x\\
\text{Recoving the integral above:}\\
-2nA_n = \frac{2}{\pi}\int_0^\pi xsin(x)dx\\
-2nA_n = \frac{-2(-1)^n}{n}\\
A_n = \frac{(-1)^n}{n^2}
\end{aligned}
\end{equation}
Substituting our coefficients, we arrive at the full solution:
\begin{tcolorbox}[minipage,colback=white,arc=0pt,outer arc=0pt]
\begin{equation}
\begin{aligned}
u(x,t) = \sum^{\infty}_{n=1}\Big{[}\frac{(-1)^n}{n^2}sin(2nt) - \frac{2(-1)^n}{n}cos(2nt)\Big{]}sin(nx)
\end{aligned}
\end{equation}
\end{tcolorbox}
\section*{\textbf{(e)}}
The TA asserted in Recitation on Friday 4/12 that with mixed BCs one still need only check $K<0$. However, it is easy to see in \textbf{(2)} above that if $K=0$ we would be applying a BC to get $X'(\pi) = C = 0$, and then similarly for $X(0) = D = 0$. $K>0$ would similarly still lead to a situation in which two exponentials with different powers were equal, once again requiring the trivial solution. We thus move forward with $K = -\lambda^2 < 0$. By ansatz, we then take the derivative and apply the BCs:
\begin{equation}
\begin{aligned}
X(x) = Asin(\lambda x) + Bcos(\lambda x)\\
X(0) = B_n = 0\\
X'(x) = \lambda Acos(\lambda x)\\
X'(\pi) = \lambda Acos(\lambda\pi) = 0\\
\lambda\pi = (n+\frac{1}{2})\pi\\
\lambda = (n+\frac{1}{2})
\end{aligned}
\end{equation}
Combining with the general solution for $T(t)$ that has been used ad nauseum we have:
\begin{equation}
\begin{aligned}
u(x,t) = \sum^{\infty}_{n=1}\Big{[}A_nsin((n+\frac{1}{2})t) + B_ncos((n+\frac{1}{2})t)\Big{]}sin((n+\frac{1}{2})x)
\end{aligned}
\end{equation}
\end{document}